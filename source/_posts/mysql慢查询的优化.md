---
title: mysql慢查询的优化
date: 2024-07-03 15:13:33
tags: [mysql, JAVA]
categories:
- [技术, JAVA]
---

# 一.Mysql慢查询如何优化？

1. 检查是否使用了索引，优化SQL使用索引
2. 检查所用索引，是否为最有索引
3. 检查所查字段是否都是必须，是否查询了过多字段，查出了多余数据
4. 检查表中数据是否过多，是否进行分库分表
5. 检查数据库所在服务器配置，适当增加资源



# 二.索引

## 1.定义

索引是一种特殊的文件(InnoDB数据表上的索引是表空间的一个组成部分)，它 们包含着对数据表里所有记录的引用指针。



## 2.分类

主键索引:数据列不允许重复，不允许为NULL， 一个表只能有一个主键。 

唯一索引:数据列不允许重复，允许为NULL值， 一个表允许多个列创建唯一索引。 

- 可以通过

  ```
  ALTER TABLE table_name ADD UNIQUE(column);
  ```

   创建唯一索引 

- 可以通过

  ```
  ALTER TABLE table_name ADD UNIQUE(column1,column2);
  ```

   创建唯一组合索引 

普通索引:基本的索引类型，没有唯一性的限制，允许为NULL值。 

- 可以通过

  ```
  ALTER TABLE table_name ADD INDEX index_name(column); 
  ```

  创建普通索引 

- 可以通过

  ```
  ALTER TABLE table_name ADD INDEX index_name(column1,column2,column3);
  ```

   创建组合索引 

全文索引：是目前搜索引擎使用的一种关键技术。 

- 可以通过

  ```
  ALTER TABLE table_name ADD FULLTEXT(column);
  ```

   创建全文索引

  

## 3.索引的数据结构

B树的特点：

1. 节点排序
2. 一个节点存多个元素，多个元素也排序



B+树的特点：

1. 拥有B树的特点
2. 叶子节点之间有指针
3. 叶子节点存储所有元素，并且排好顺序



Mysql索引使用的是B+树，因为索引是用来加快查询速度的，而B+树通过对数据进行排序，叶子节点存储了所有元素，从而使B+树不会太高，而且叶子节点有指针，可以支持全表扫描，范围查找等SQL语句



## 4.索引失效

1. 查询条件中有or,即使有部分条件带索引也会失效
2. like查询是以%开头
3. 如果列类型是字符串，那在查询条件中需要将数据用引号引用起来，否则不走索引
4. 索引列上参与计算会导致索引失效
5. 违背最左匹配原则
6. 如果mysql估计全表扫描要比使用索引要快，会不适用索引
